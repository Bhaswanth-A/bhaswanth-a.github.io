<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Analysis of Battery in Low Power Electric Vehicles using Machine Learning" /><meta name="author" content="<author_id>" /><meta property="og:locale" content="en" /><meta name="description" content="The following project has been done as part of my Practice School-1 cirriculum under CSIR - Central Electronics Engineering Research Institute (CEERI), Pilani. It enabled me to work on real-world issues and provided me with an opportunity to obtain industrial experience under the guidance of Dr. Bhausaheb Ashok Botre, Principal Scientist." /><meta property="og:description" content="The following project has been done as part of my Practice School-1 cirriculum under CSIR - Central Electronics Engineering Research Institute (CEERI), Pilani. It enabled me to work on real-world issues and provided me with an opportunity to obtain industrial experience under the guidance of Dr. Bhausaheb Ashok Botre, Principal Scientist." /><link rel="canonical" href="https://bhaswanth-a.github.io//posts/ev/" /><meta property="og:url" content="https://bhaswanth-a.github.io//posts/ev/" /><meta property="og:site_name" content="Bhaswanth Ayapilla" /><meta property="og:image" content="https://bhaswanth-a.github.io//assets/images/Thumbnail/evml_rsz.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-28T21:30:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://bhaswanth-a.github.io//assets/images/Thumbnail/evml_rsz.jpg" /><meta property="twitter:title" content="Analysis of Battery in Low Power Electric Vehicles using Machine Learning" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@<author_id>" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"<author_id>"},"dateModified":"2024-12-14T03:54:47+05:30","datePublished":"2022-07-28T21:30:00+05:30","description":"The following project has been done as part of my Practice School-1 cirriculum under CSIR - Central Electronics Engineering Research Institute (CEERI), Pilani. It enabled me to work on real-world issues and provided me with an opportunity to obtain industrial experience under the guidance of Dr. Bhausaheb Ashok Botre, Principal Scientist.","headline":"Analysis of Battery in Low Power Electric Vehicles using Machine Learning","image":"https://bhaswanth-a.github.io//assets/images/Thumbnail/evml_rsz.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://bhaswanth-a.github.io//posts/ev/"},"url":"https://bhaswanth-a.github.io//posts/ev/"}</script><title>Analysis of Battery in Low Power Electric Vehicles using Machine Learning | Bhaswanth Ayapilla</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Bhaswanth Ayapilla"><meta name="application-name" content="Bhaswanth Ayapilla"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/prfl.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Bhaswanth Ayapilla</a></div><div class="site-subtitle font-italic">Vision | Reinforcement Learning</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-user ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/cmu/" class="nav-link"> <i class="fa-fw fas fa-school ml-xl-3 mr-xl-3 unloaded"></i> <span>CMU MRSD</span> </a><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-blog ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOG</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/cv/" class="nav-link"> <i class="fa-fw fas fa-file ml-xl-3 mr-xl-3 unloaded"></i> <span>CURRICULUM VITAE</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fas fa-address-book ml-xl-3 mr-xl-3 unloaded"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Bhaswanth-A" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['bhaswanthayapilla','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="https://www.instagram.com/bhaswanth_a/" aria-label="instagram" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://www.linkedin.com/in/bhaswanth-a/" aria-label="linkedin" class="order-6" target="_blank" rel="noopener"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://bhaswanth-a.github.io/cv/" aria-label="cv" class="order-7" target="_blank" rel="noopener"> <i class="fas fa-file"></i> </a> <span id="mode-toggle-wrapper" class="order-1"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script> </span></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Analysis of Battery in Low Power Electric Vehicles using Machine Learning</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Analysis of Battery in Low Power Electric Vehicles using Machine Learning</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1659024000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 28, 2022 </em> </span> <span> Updated <em class="" data-ts="1734128687" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 13, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Bhaswanth Ayapilla </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2724 words"> <em>15 min</em> read</span></div></div></div><div class="post-content"><p>The following project has been done as part of my Practice School-1 cirriculum under <a href="https://www.ceeri.res.in/">CSIR - Central Electronics Engineering Research Institute (CEERI), Pilani</a>. It enabled me to work on real-world issues and provided me with an opportunity to obtain industrial experience under the guidance of Dr. Bhausaheb Ashok Botre, Principal Scientist.</p><h1 id="abstract"><strong>Abstract</strong></h1><p>Due to its numerous favorable effects on the environment and society, electric vehicles (EVs) are growing in popularity around the world. This Project Report discusses the use of Machine Learning techniques for the analysis of batteries in low power Electric-tricycle. The report talks about the use of machine learning techniques such as Random Forest (RF) and Gradient Boosting Regression Tree (GBRT) for State of Charge (SOC) estimation and load forecasting. MATLAB simulations for speed control of a BLDC motor using PID controller and a Lithium-ion temperature dependent battery model are used to predict the SOC and the power of the battery. The data generated from these simulations is used to train the ML models.</p><p><strong>Project Areas:</strong> Electric Vehicles, Machine Learning.</p><p><strong>Keywords:</strong> Machine Learning, State of Charge, BMS, Load Forecasting, BLDC motor.</p><h1 id="introduction">Introduction</h1><p>Electric Vehicles are becoming increasingly integrated in several cities. With increasing EV technology and smart power grids, they have emerged as an alternative to the conventional gas driven vehicles. Being more environmentally friendly, people are rapidly moving towards EVs.</p><p>Battery charging in EVs is still a major challenge and continuous research efforts are being made to build an efficient system to analyze the various parameters of the batteries being used. Accurate analysis needs to be performed to prevent any battery failure and occurrence of any accidents.</p><h1 id="problem-statement">Problem Statement</h1><p>The aim of this project is to analyze batteries in low power Electric Vehicles using Machine Learning techniques. CEERI Pilani has developed an electric assisted tricycle for the outdoor mobility of differently abled persons and aims to improve it by incorporating an efficient Battery Management System using IoT and ML techniques.</p><h1 id="challenges-addressed">Challenges Addressed</h1><p>A number of challenges are involved in analyzing the batteries of Electric Vehicles, which include:</p><ol><li>Prediction of driving range<li>Performance of battery<li>Charge load conditions<li>State of charge (SOC) estimation</ol><p>The absence of high-quality, full-scale datasets is one of the most critical challenges faced in the accurate prediction of batteries in EVs. But in recent times, one major starting point in the prediction of battery safety is the simulation of the loading conditions. My personal objective is to focus on the EV load conditions and SOC estimation techniques to help build an efficient battery management system (BMS).</p><p>Analysis of EV charge load conditions implies analyzing the power of the battery during peak demands. It also looks at how charging the EV affects the battery. It is important because EV load balancing instructs the chargers to deliver the right amount of energy and manages the energy flow. So analyzing the energy trends of the battery would tell us its charge load characteristics.</p><p>The most critical inputs for controlling EV charging and improving power system operation and performance are accurate early knowledge of the EV load demand. Moreover, factors such as driving and travel patterns of each EV lead to a stochastic nature of the EV charging demand.</p><p>SOC is a number between 0 and 1 that indicates the amount of charge available in the cell relative to the maximum amount of charge. A major challenge with SOC is that it cannot be measured directly but it needs to be inferred based on measurements of voltage, current, temperature and the use of a model of the cell. However, some Simulink models of batteries let us obtain SOC data directly which is extremely beneficial.</p><h1 id="machine-learning">Machine Learning</h1><p>There exist a number of traditional techniques for EV load analysis and SOC estimation. But most of them have been proved less efficient in recent times, and with the rise of machine learning, we have a lot more options to help in load forecasting and SOC estimation.</p><p>A popular way of modeling batteries with the purpose of system design and charge load analysis is to create an electro-thermal analogy for the cell’s behavior, i.e, to create an equivalent circuit. The topology and parameters of the equivalent circuit should allow us to load it in the same way we would load a battery and observe the same response a battery would have. This includes voltage drop, relaxation times and open circuit voltage, as functions of temperature and state of charge (SOC).</p><p>The easiest way to estimate SOC is integrating current. It is a computationally cheap method but the disadvantage is that any error in the measurement of current will accumulate over time, making the SOC diverge from its true value.</p><p>A more advanced method of estimating SOC is the use of observers such as Kalman filters. The Kalman filter takes in the model of the cell and uses a recursive algorithm that continuously predicts a future state and corrects it using measurements performed on the system. But this is computationally very expensive.</p><p>An alternative would be to use Machine Learning models that take the relevant parameters and use them to predict the desired features. Trained with a sufficiently large amount of data measured under sufficiently varied conditions, ML models would be able to learn the patterns of change in the measurable quantities of the battery and link them to predict the SOC and power/energy trends.</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image11.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image11.png" data-proofer-ignore></p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image26.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image26.png" data-proofer-ignore></p><p>Machine learning algorithms provide a variety of approaches for forecasting EV load conditions and SOC estimation. Random Forest (RF) and Gradient Boosting Regression Tree (GBRT) are two such techniques that have lately proven to be useful.</p><h2 id="random-forest-rf"><span class="mr-2">Random Forest (RF):</span><a href="#random-forest-rf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Random Forest algorithm is based on decision trees. A decision tree is a model that follows a path from the branched observations to the outcomes. We use regression trees since the outcomes (power/energy consumption and SOC) have continuous values.</p><p>Random Forest Regression is a supervised learning approach for regression that employs ensemble learning methods. Ensemble learning method is a technique that combines predictions from multiple machine learning algorithms to make a more accurate prediction than a single model.</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image3.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image3.png" data-proofer-ignore></p><p>The diagram above shows the structure of a RF. The trees run in parallel with no interaction amongst them. An RF operates by constructing several decision trees during training time and outputting the mean of the classes as the prediction of all the trees.</p><p>Random Forest Regression is a powerful and precise model. It usually works well on a wide range of issues, including those with non-linear relationships.</p><h2 id="gradient-boosting-regression-tree-gbrt"><span class="mr-2">Gradient Boosting Regression Tree (GBRT):</span><a href="#gradient-boosting-regression-tree-gbrt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>GBRT is also based on decision trees and ensemble learning. It also works on the concept of Boosting, which works on the principle of improving mistakes of the previous learner through the next learner. In boosting, weak learners are used which perform only slightly better than a random chance.</p><p>In GBRT, we combine many weak learners to come up with one strong learner. The weak learners here are the individual decision trees. All the trees are connected in series and each tree tries to minimize the error of the previous tree. Due to this sequential connection, boosting algorithms are usually slow to learn, but also highly accurate.</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image4.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image4.png" data-proofer-ignore></p><p>Overfitting owing to the inclusion of too many trees is a problem that we may face in GBRT but not in Random Forests. Overfitting will not occur in RF if you add too many trees. Although the model’s accuracy does not improve after a certain point, there is no issue with overfitting. However, when using GBRT, we must be cautious about the amount of trees we choose, as having too many weak learners in the model can lead to data overfitting. As a result, hyperparameter optimization is quite important.</p><h1 id="simulations">Simulations</h1><p>MATLAB is a great software platform that provides us with a number of tools that can be used to model an EV system. Two Simulink models were created to obtain data used for SOC estimation and load forecasting.</p><ol><li>Lithium-Ion Temperature Dependent Battery Model<li>Speed Control of a BLDC Motor using PID Controller</ol><p>These two individual models were then interfaced together to create a single large model that predicts SOC and power trends in the presence of a BLDC motor as load.</p><h2 id="lithium-ion-temperature-dependent-battery-model"><span class="mr-2">Lithium-Ion Temperature Dependent Battery Model</span><a href="#lithium-ion-temperature-dependent-battery-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This model shows the variation in performance of a 7.2 V, 5.4 Ah Lithium-Ion battery. Throughout a discharge and charge operation, the model is exposed to an environment with varying ambient temperature. Its performance is contrasted with the scenario in which temperature effects are disregarded. The temperature dependent battery model functions reasonably well, as seen from the scope. The output voltage and capacity change together with the cell’s internal temperature as a result of charge (or discharge) heat losses and variations in the outside temperature.</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image20.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image20.png" data-proofer-ignore></p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image7.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image7.png" data-proofer-ignore></p><p>The data from the scope can be extracted into an excel sheet, as shown below, containing all the necessary parameters. By using data of only the relevant parameters, ML models can be trained to estimate the SOC and power trends (for load forecasting).</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image22.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image22.png" data-proofer-ignore></p><h2 id="speed-control-of-a-bldc-motor-using-pid-controller"><span class="mr-2">Speed Control of a BLDC Motor using PID Controller</span><a href="#speed-control-of-a-bldc-motor-using-pid-controller" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This model displays the functionality of a Brushless DC motor coupled to a PID controller for precision and stability. Ignoring the effects of temperature, a Lithium-Ion battery is connected to the motor. We use the scope to monitor changes in stator currents, motor speed, and electromagnetic torque. The PID controller ensures that the motor’s speed is consistently maintained at the required rpm specified in the input.</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image1.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image1.png" data-proofer-ignore></p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image24.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image24.png" data-proofer-ignore></p><h2 id="complete-model"><span class="mr-2">Complete Model</span><a href="#complete-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The two models generated above are combined to obtain one single large model. This demo shows the performance of the Lithium-Ion battery in the presence of a load, i.e., BLDC motor, its variation with change in temperature and allows us to measure motor speed as well.</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image23.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image23.png" data-proofer-ignore></p><p>The information from the scope can be retrieved into an excel file that includes all the relevant parameters. This complete data can then be used to train the ML models that will accurately predict the SOC and the power/energy consumed for load forecasting.</p><h1 id="results">Results</h1><p>The complete MATLAB simulation, however, is extremely heavy and time consuming, and requires higher specs and computational power to run. So the ML models were trained based on data generated from the battery without the presence of a load.</p><h2 id="datasets"><span class="mr-2">Datasets</span><a href="#datasets" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The data obtained from the MATLAB simulation in an excel sheet is shuffled randomly and divided into training sets and testing sets.</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image21.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image21.png" data-proofer-ignore></p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image10.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image10.png" data-proofer-ignore></p><h2 id="random-forest"><span class="mr-2">Random Forest</span><a href="#random-forest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Scikit learn library is used to run the Random Forest model and is trained on the training dataset. The trained model is then tested on the test dataset and the accuracy is measured.</p><p><strong>Code:</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre><span class="c1"># Importing the libraries
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># Train set
</span><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'train_parameters_updated.csv'</span><span class="p">)</span>

<span class="n">energy</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">4</span><span class="p">].</span><span class="n">values</span>
<span class="n">soc</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">].</span><span class="n">values</span> 
<span class="n">time</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">].</span><span class="n">values</span> <span class="c1"># X
</span>
<span class="c1"># Test set
</span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'test_parameters_updated.csv'</span><span class="p">)</span>

<span class="n">energy_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">4</span><span class="p">].</span><span class="n">values</span>
<span class="n">soc_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">].</span><span class="n">values</span> 
<span class="n">time_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">].</span><span class="n">values</span> <span class="c1"># X
</span>
<span class="c1"># Predict SOC
</span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="n">regressor_1</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">regressor_1</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">soc</span><span class="p">)</span>

<span class="c1"># Visualizing the SOC Set 
</span><span class="n">X_grid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">X_grid</span> <span class="o">=</span> <span class="n">X_grid</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_grid</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time_test</span><span class="p">,</span> <span class="n">soc_pred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">regressor_1</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_grid</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Random Forest Regression'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'SOC'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Predict Energy
</span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="n">regressor_2</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">regressor_2</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">energy</span><span class="p">)</span>

<span class="n">energy_pred</span> <span class="o">=</span> <span class="n">regressor_2</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">time_test</span><span class="p">)</span>

<span class="c1"># Visualizing the Energy Set 
</span><span class="n">X_grid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">X_grid</span> <span class="o">=</span> <span class="n">X_grid</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_grid</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time_test</span><span class="p">,</span> <span class="n">energy_pred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">regressor_2</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_grid</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Random Forest Regression'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Energy'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Accuracy of SOC estimation
</span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="n">r2_score</span><span class="p">(</span><span class="n">soc_pred</span><span class="p">,</span><span class="n">soc_test</span><span class="p">)</span>

<span class="c1"># Accuracy of Energy estimation
</span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="n">r2_score</span><span class="p">(</span><span class="n">energy_pred</span><span class="p">,</span><span class="n">energy_test</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>Predicting SOC:</strong></p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image19.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image19.png" data-proofer-ignore></p><p>Accuracy: 99%</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image9.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image9.png" data-proofer-ignore></p><p><strong>Predicting Energy:</strong></p><p>The data for energy is obtained by multiplying the voltage and the current. The trends in energy are used for load forecasting.</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image14.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image14.png" data-proofer-ignore></p><p>Accuracy: 99%</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image16.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image16.png" data-proofer-ignore></p><p><strong>Model Summary:</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">sklearn.metrics</span> <span class="k">as</span> <span class="n">metrics</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">soc_test</span><span class="p">,</span> <span class="n">soc_pred</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">soc_test</span><span class="p">,</span> <span class="n">soc_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span> <span class="c1"># or mse**(0.5)  
</span><span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">soc_test</span><span class="p">,</span><span class="n">soc_pred</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Results of sklearn.metrics:"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"MAE:"</span><span class="p">,</span><span class="n">mae</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"MSE:"</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"RMSE:"</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"R-Squared:"</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">energy_test</span><span class="p">,</span> <span class="n">energy_pred</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">energy_test</span><span class="p">,</span> <span class="n">energy_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span> <span class="c1"># or mse**(0.5)  
</span><span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">energy_test</span><span class="p">,</span><span class="n">energy_pred</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Results of sklearn.metrics:"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"MAE:"</span><span class="p">,</span><span class="n">mae</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"MSE:"</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"RMSE:"</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"R-Squared:"</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
</pre></table></code></div></div><p>For SOC: MAE: 0.0007033089960029275 MSE: 7.885088251654824e-07 RMSE: 0.0008879801941290596 R-Squared: 0.9999999861769471</p><p>For Energy: MAE: 0.0042136681167083585 MSE: 0.15557361977356302 RMSE: 0.3944282187845629 R-Squared: 0.9995374972380205</p><h2 id="gradient-boosting-regression-tree"><span class="mr-2">Gradient Boosting Regression Tree</span><a href="#gradient-boosting-regression-tree" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This model also uses the Scikit learn library to train the model on the training data. The trained model is then tested on the test dataset and the accuracy is measured.</p><p><strong>Code:</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
</pre><td class="rouge-code"><pre><span class="c1"># Load libraries
</span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">'ignore'</span><span class="p">)</span>

<span class="c1"># Train set
</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'train_parameters_updated.csv'</span><span class="p">)</span>

<span class="n">energy</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">4</span><span class="p">].</span><span class="n">values</span>
<span class="n">soc</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">].</span><span class="n">values</span> 
<span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">].</span><span class="n">values</span> <span class="c1"># X
</span>
<span class="n">gradientregressor</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Test set
</span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'test_parameters_updated.csv'</span><span class="p">)</span>

<span class="n">energy_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">4</span><span class="p">].</span><span class="n">values</span>
<span class="n">soc_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">].</span><span class="n">values</span> 
<span class="n">time_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">].</span><span class="n">values</span> <span class="c1"># X
</span>
<span class="c1"># Predict SOC
</span><span class="n">model</span> <span class="o">=</span> <span class="n">gradientregressor</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">soc</span><span class="p">)</span>
<span class="n">soc_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">time_test</span><span class="p">)</span>

<span class="c1"># Visualizing the SOC Set 
</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">X_grid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">X_grid</span> <span class="o">=</span> <span class="n">X_grid</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_grid</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">soc</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'GBRT'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'SOC'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Predict Energy
</span><span class="n">model_2</span> <span class="o">=</span> <span class="n">gradientregressor</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">energy</span><span class="p">)</span>
<span class="n">energy_pred</span> <span class="o">=</span> <span class="n">model_2</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">time_test</span><span class="p">)</span>

<span class="c1"># Visualizing the Voltage Set 
</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">X_grid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">X_grid</span> <span class="o">=</span> <span class="n">X_grid</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_grid</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time_test</span><span class="p">,</span> <span class="n">energy_pred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">model_2</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_grid</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'GBRT'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Energy'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Accuracy of SOC estimation
</span><span class="n">r2_score</span><span class="p">(</span><span class="n">soc_pred</span><span class="p">,</span><span class="n">soc_test</span><span class="p">)</span>

<span class="c1"># Accuracy of Energy estimation
</span><span class="n">r2_score</span><span class="p">(</span><span class="n">energy_pred</span><span class="p">,</span><span class="n">energy_test</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>Predicting SOC:</strong></p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image15.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image15.png" data-proofer-ignore></p><p>Accuracy: 93%</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image5.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image5.png" data-proofer-ignore></p><p><strong>Predicting Energy:</strong></p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image25.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image25.png" data-proofer-ignore></p><p>Accuracy: 99%</p><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image18.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image18.png" data-proofer-ignore></p><p><strong>Model Summary:</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">sklearn.metrics</span> <span class="k">as</span> <span class="n">metrics</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">soc_test</span><span class="p">,</span> <span class="n">soc_pred</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">soc_test</span><span class="p">,</span> <span class="n">soc_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span> <span class="c1"># or mse**(0.5)  
</span><span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">soc_test</span><span class="p">,</span><span class="n">soc_pred</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Results of sklearn.metrics:"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"MAE:"</span><span class="p">,</span><span class="n">mae</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"MSE:"</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"RMSE:"</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"R-Squared:"</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">energy_test</span><span class="p">,</span> <span class="n">energy_pred</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">energy_test</span><span class="p">,</span> <span class="n">energy_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span> <span class="c1"># or mse**(0.5)  
</span><span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">energy_test</span><span class="p">,</span><span class="n">energy_pred</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Results of sklearn.metrics:"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"MAE:"</span><span class="p">,</span><span class="n">mae</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"MSE:"</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"RMSE:"</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"R-Squared:"</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
</pre></table></code></div></div><p>For SOC: MAE: 1.594852472588293 MSE: 3.6870569829698217 RMSE: 1.9201710816929365 R-Squared: 0.9353635847153323</p><p>For Energy: MAE: 0.13236938942063645 MSE: 0.18590540743040299 RMSE: 0.4311674934760307 R-Squared: 0.9994473242666165</p><p><strong>Comparison:</strong></p><p>By comparing the accuracies of the two models, RF and GBRT, we see that the RF algorithm performs better than the other over the same training set. While GBRT gives a comparable accuracy as that of RF in predicting the energy, the main difference comes in predicting the SOC.</p><p>So the RF model would be a better choice for data estimation, as seen from the experiments performed on the data generated from the MATLAB simulations.</p><div class="table-wrapper"><table><thead><tr><th>Regression Algorithm<th style="text-align: center">Accuracy (R^2 score)<th> <th style="text-align: center">Mean Absolute Error (MAE)<th> <th style="text-align: center">Root Mean Square Error (RMSE)<th> <tbody><tr><td> <td style="text-align: center">SOC<td>Energy<td style="text-align: center">SOC<td>Energy<td style="text-align: center">SOC<td>Energy<tr><td>Random Forest<td style="text-align: center">99.9%<td>99.9%<td style="text-align: center">0.0007<td>0.0042<td style="text-align: center">0.0008<td>0.3944<tr><td>Gradient Boosting Regression Tree<td style="text-align: center">93.5%<td>99.9%<td style="text-align: center">1.5948<td>0.1324<td style="text-align: center">1.9202<td>0.4312</table></div><p><img data-src="/assets/images/Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image6.png" alt="Analysis%20of%20Battery%20in%20Low%20Power%20Electric%20Vehicles%20b760508ef28d465db5bbb54a2860fb8d/image6.png" data-proofer-ignore></p><h1 id="conclusion">Conclusion</h1><p>The development of an efficient battery management system using the previously-mentioned methods would help build safer EVs. By making data analysis more practical, the research being conducted would help reduce the gap between the tests in labs and the real-time conditions. This will help prevent any accidents that can be caused by faults in batteries.</p><p>The data generated from the MATLAB simulations were extracted and the essential parameters served as the input to the two different machine learning algorithms used to predict the SOC and power/energy consumed. Promising results were obtained with more than 90% accuracy in the regression models, and I believe that this can be increased with the help of more data.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/projects/'>Projects</a>, <a href='/categories/ml/'>ML</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ml/" class="post-tag no-text-decoration" >ml</a> <a href="/tags/ev/" class="post-tag no-text-decoration" >ev</a> <a href="/tags/matlab/" class="post-tag no-text-decoration" >matlab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.facebook.com/sharer/sharer.php?title=Analysis+of+Battery+in+Low+Power+Electric+Vehicles+using+Machine+Learning+-+Bhaswanth+Ayapilla&u=https%3A%2F%2Fbhaswanth-a.github.io%2F%2Fposts%2Fev%2F" data-toggle="tooltip" data-placement="top" title="Instagram" target="_blank" rel="noopener" aria-label="Instagram"> <i class="fa-fw fab fa-instagram"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Analysis+of+Battery+in+Low+Power+Electric+Vehicles+using+Machine+Learning+-+Bhaswanth+Ayapilla&u=https%3A%2F%2Fbhaswanth-a.github.io%2F%2Fposts%2Fev%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fbhaswanth-a.github.io%2F%2Fposts%2Fev%2F&text=Analysis+of+Battery+in+Low+Power+Electric+Vehicles+using+Machine+Learning+-+Bhaswanth+Ayapilla" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fbhaswanth-a.github.io%2F%2Fposts%2Fev%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/cmu-blog/">Coursework at CMU</a><li><a href="/posts/lunar-roadster-cmu/">Lunar ROADSTER</a><li><a href="/posts/learning-3d-vision-25/">Learning for 3D Vision</a><li><a href="/posts/robot-autonomy-25/">Robot Autonomy</a><li><a href="/posts/intro-robotics-business-25/">Introduction to Robotics Business</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/learning/">learning</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/control/">control</a> <a class="post-tag" href="/tags/nnets/">nnets</a> <a class="post-tag" href="/tags/arduino/">arduino</a> <a class="post-tag" href="/tags/computer-vision/">computer vision</a> <a class="post-tag" href="/tags/electronics/">electronics</a> <a class="post-tag" href="/tags/rl/">rl</a> <a class="post-tag" href="/tags/simulation/">simulation</a> <a class="post-tag" href="/tags/matlab/">matlab</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/iot-disaster-management-system/"><div class="card-body"> <em class="small" data-ts="1660233600" data-df="ll" > Aug 11, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Disaster Management System for Floods using IoT and ML</h3><div class="text-muted small"><p> Introduction Floods are the most catastrophic and cataclysmic events of all-natural disasters. The World Meteorological Organization has stated that out of all the disasters in the world, floods...</p></div></div></a></div><div class="card"> <a href="/posts/traffic-signs-recognition/"><div class="card-body"> <em class="small" data-ts="1660233600" data-df="ll" > Aug 11, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Recognizing Traffic Signs using CNNs</h3><div class="text-muted small"><p> Introduction The following project shows the implementation of a simple convolutional neural network (CNN). The model will be able to identify which signal it is when presented with a colour ima...</p></div></div></a></div><div class="card"> <a href="/posts/transnomous/"><div class="card-body"> <em class="small" data-ts="1660233600" data-df="ll" > Aug 11, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Autonomous Ground Vehicle</h3><div class="text-muted small"><p> To be Updated</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/electronics/" class="btn btn-outline-primary" prompt="Older"><p>Basic Electronics</p></a> <a href="/posts/numpy/" class="btn btn-outline-primary" prompt="Newer"><p>Numpy</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Bhaswanth-A">Bhaswanth Ayapilla</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/learning/">learning</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/control/">control</a> <a class="post-tag" href="/tags/nnets/">nnets</a> <a class="post-tag" href="/tags/arduino/">arduino</a> <a class="post-tag" href="/tags/computer-vision/">computer vision</a> <a class="post-tag" href="/tags/electronics/">electronics</a> <a class="post-tag" href="/tags/rl/">rl</a> <a class="post-tag" href="/tags/simulation/">simulation</a> <a class="post-tag" href="/tags/matlab/">matlab</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-CJ97GH1VYR"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-CJ97GH1VYR'); }); </script>
