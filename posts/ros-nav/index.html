<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="ROS Navigation" /><meta name="author" content="<author_id>" /><meta property="og:locale" content="en" /><meta name="description" content="ROS Navigation" /><meta property="og:description" content="ROS Navigation" /><link rel="canonical" href="https://bhaswanth-a.github.io//posts/ros-nav/" /><meta property="og:url" content="https://bhaswanth-a.github.io//posts/ros-nav/" /><meta property="og:site_name" content="Bhaswanth Ayapilla" /><meta property="og:image" content="https://bhaswanth-a.github.io//assets/images/ros_nav_1.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-28T12:00:00-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://bhaswanth-a.github.io//assets/images/ros_nav_1.png" /><meta property="twitter:title" content="ROS Navigation" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@<author_id>" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"<author_id>"},"dateModified":"2024-01-05T19:09:56-05:00","datePublished":"2022-07-28T12:00:00-04:00","description":"ROS Navigation","headline":"ROS Navigation","image":"https://bhaswanth-a.github.io//assets/images/ros_nav_1.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://bhaswanth-a.github.io//posts/ros-nav/"},"url":"https://bhaswanth-a.github.io//posts/ros-nav/"}</script><title>ROS Navigation | Bhaswanth Ayapilla</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Bhaswanth Ayapilla"><meta name="application-name" content="Bhaswanth Ayapilla"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/prfl.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Bhaswanth Ayapilla</a></div><div class="site-subtitle font-italic">Perception | Reinforcement Learning</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-user ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/cmu/" class="nav-link"> <i class="fa-fw fas fa-school ml-xl-3 mr-xl-3 unloaded"></i> <span>CMU MRSD</span> </a><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-blog ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOG</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/cv/" class="nav-link"> <i class="fa-fw fas fa-file ml-xl-3 mr-xl-3 unloaded"></i> <span>CURRICULUM VITAE</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fas fa-address-book ml-xl-3 mr-xl-3 unloaded"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Bhaswanth-A" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['bhaswanthayapilla','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="https://www.instagram.com/bhaswanth_a/" aria-label="instagram" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://www.linkedin.com/in/bhaswanth-a/" aria-label="linkedin" class="order-6" target="_blank" rel="noopener"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://bhaswanth-a.github.io/cv/" aria-label="cv" class="order-7" target="_blank" rel="noopener"> <i class="fas fa-file"></i> </a> <span id="mode-toggle-wrapper" class="order-1"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script> </span></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>ROS Navigation</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>ROS Navigation</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1659024000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 28, 2022 </em> </span> <span> Updated <em class="" data-ts="1704499796" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 6, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Bhaswanth Ayapilla </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3100 words"> <em>17 min</em> read</span></div></div></div><div class="post-content"><h1 id="ros-navigation">ROS Navigation</h1><h2 id="11-introduction"><span class="mr-2">1.1 Introduction</span><a href="#11-introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The ROS Navigation stack takes in information from odometry, sensor streams, and a goal pose and outputs safe velocity commands that are sent to a mobile base.</p><p>The entire process of robot navigation can be divided into 3 major parts:</p><ul><li>Mapping<li>Localization<li>Path Planning</ul><h2 id="12-mapping"><span class="mr-2">1.2 Mapping</span><a href="#12-mapping" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In order to perform autonomous navigation, the robot must have a map of the environment. The robot will use this map for many things such as planning trajectories, avoiding obstacles, etc.</p><p>Rviz is a very important tool that will be used extensively in the mapping process. For Mapping, you will basically need to use 2 displays of Rviz:</p><ul><li>LaserScan Display<li>Map Display</ul><h3 id="121-slam"><span class="mr-2">1.2.1 SLAM</span><a href="#121-slam" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Simultaneous Localization and Mapping refers to building a map of an unknown environment while simultaneously keeping track of the robot’s location on the map that is being built.</p><p>This scenario in Robotics is solved using the <strong>gmapping</strong> package on ROS.</p><h3 id="122-gmapping-package"><span class="mr-2">1.2.2 gmapping package</span><a href="#122-gmapping-package" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The gmapping package implements a special SLAM algorithm called <strong><em>gmapping</em></strong>. We don’t need to know how to code the alogrithm ourselves but just need to learn how to configure the package for our robot to suit our needs.</p><p>The gmapping package contains a ROS node called <strong>slam_gmapping</strong> that allows us to create a 2D map using the laser and odom data provided by the robot while navigating the given environment. This node basically reads data from the laser and the transforms of the robot, and turns it into an Occupancy Grid Map (OGM).</p><ol><li><p>Launch gazebo - <code class="language-plaintext highlighter-rouge">roslaunch turtlebot3_gazebo turtlebot3_house.launch</code></p><li><p>Launch the gmapping package with the robot (turtlebot3 in our case) by using a previously created launch file <em>turtlebot3_gmapping.launch</em>.</p><p>To do so, run the command: <code class="language-plaintext highlighter-rouge">roslaunch turtlebot3_slam turtlebot3_gmapping.launch</code></p><li><p>This launch file starts the <strong>turtlebot3_slam_gmapping</strong> node from the gmapping package.</p><li><p>The <strong>turtlebot3_slam_gmapping</strong> node subscribes to the Laser topic (<strong>/scan</strong>) and Transform topic(<strong>/tf</strong>) to get laser and odom data from the robot, which it needs to build the map.</p><li><p>The generated map is published during the whole process into the <strong>/map</strong> topic, which reflects on Rviz.</p><li><p>In order to visualize this map on Rviz, enter to following command:</p><p><code class="language-plaintext highlighter-rouge">roslaunch turtlebot3_gazebo turtlebot3_gazebo_rviz.launch</code></p><li><p>Enter the following command to move the turtlebot3 and to produce a map of the complete environment.</p><p><code class="language-plaintext highlighter-rouge">roslaunch turtlebot3_teleop turtlebot3_teleop_key.launch</code></p></ol><p>The <strong>/map</strong> topic uses the message type <strong>nav_msgs/OccupancyGrid</strong> since it is an OGM. The occupancy is represented as an integer in the range {0,100}.</p><ul><li><strong>0</strong> implies completely free<li><strong>100</strong> implies completely occupied<li>-<strong>1</strong> implies completely unknown.</ul><p><img data-src="/assets/images/ROS/Nav/1.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/2.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/3.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/4.png" alt="" data-proofer-ignore></p><h4 id="rviz"><span class="mr-2">Rviz:</span><a href="#rviz" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>On entering <code class="language-plaintext highlighter-rouge">roslaunch turtlebot3_gazebo turtlebot3_gazebo_rviz.launch</code>, you will see something like this on the Rviz window:</p><p><img data-src="/assets/images/ROS/Nav/5.png" alt="" data-proofer-ignore></p><p>This however, does not have the map display and hence we cannot see the map of the environment produced by the robot. To get the map display, click on <strong>“Add”</strong> and select <strong>“Map”</strong>.</p><p>Now in the Map display, select the topic name <strong>/map</strong> to visualize the map being made in real-time by your robot.</p><p><img data-src="/assets/images/ROS/Nav/6.png" alt="" data-proofer-ignore></p><p>You can now navigate your robot the obtain a map of the complete environment.</p><p>The finished map should look something like this.</p><p><img data-src="/assets/images/ROS/Nav/7.png" alt="" data-proofer-ignore></p><h3 id="123-map_server"><span class="mr-2">1.2.3 map_server</span><a href="#123-map_server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>map_server</strong> is a package belonging to the ROS Navigation Stack.</p><h4 id="saving-a-map"><span class="mr-2">Saving a map</span><a href="#saving-a-map" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>It provides a <strong>map_saver</strong> node which allows us to access the map data from a ROS Service and save it into a file.</p><p>When you request the map_saver to save the current map, the map data is saved into two files:</p><ul><li>YAML file - contains the image name and the metadata of the map<li>Image_name.pgm - this contains the image itself, which has the encoded data of the OGM. pgm stands for Portable Gray Map</ul><p>To save the built map, enter the following command: <code class="language-plaintext highlighter-rouge">rosrun map_server map_saver -f &lt;map_name&gt;</code></p><p><img data-src="/assets/images/ROS/Nav/8.png" alt="" data-proofer-ignore></p><p>To open the map image, enter <code class="language-plaintext highlighter-rouge">xdg-open &lt;map_name&gt;.pgm</code></p><p><img data-src="/assets/images/ROS/Nav/9.png" alt="" data-proofer-ignore></p><p>Contents of YAML file:</p><ul><li><strong>image</strong>: Name of the file containing the image of the generated map<li><strong>resolution</strong>: Resolution of the map (in meters/pixel)<li><strong>origin</strong>: Coordinates of the lower-left pixel in the map. The first two values indicate position and the third value indicates rotation.<li><strong>negate</strong>: Inverts the colors of the map. 0 by default<li><strong>occupied_thresh</strong>: Pixels which have a value greater than this value will be considered as completely occupied<li><strong>free_thresh</strong>: Pixels which have a value smaller than this value will be considered as completely free</ul><p><img data-src="/assets/images/ROS/Nav/10.png" alt="" data-proofer-ignore></p><h4 id="providing-a-map"><span class="mr-2">Providing a map</span><a href="#providing-a-map" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The map_server package also provides the <strong>map_server</strong> node that reads a map file and provides it to any other node that requests it via a ROS Service. This request is done, for example, by the move_base node to get data from a map and use it for Path Planning, or by the localization node in order to find the position of the robot in the map.</p><p>The service to call to get the map is <strong>/static_map</strong> (<strong>nav_msgs/GetMap</strong>).</p><p><img data-src="/assets/images/ROS/Nav/11.png" alt="" data-proofer-ignore></p><p>Apart from requesting the map through the GetMap service, there are two topics that you can connect to in order to obtain ROS Messages about the map.</p><ul><li><strong>/map_metadata (nav_msgs/MapMetaData</strong>): Provides map metadata<li><strong>/map (nav_msgs/OccupancyGrid)</strong>: Provides the map occupancy data</ul><p>Enter the following command to launch the map_server node in order to provide the map information: <code class="language-plaintext highlighter-rouge">rosrun map_server map_server &lt;map_name&gt;.yaml</code></p><p><img data-src="/assets/images/ROS/Nav/12.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/13.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/14.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/15.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/16.png" alt="" data-proofer-ignore></p><blockquote><p>The map that is created is a <strong>static map</strong> which means that the details of the map will not change or update with time. If the environment changes in the future, then these changes will not reflect in the map.</p><p>The map that is created is a 2D map, which means that the obstacles that appear in the map don’t have any height. So these maps will be invalid in projects where you would want to navigate a drone or an underwater rover. For such cases, you would have to use 3D mappings.</p></blockquote><h4 id="creating-a-service-client"><span class="mr-2">Creating a Service Client</span><a href="#creating-a-service-client" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>This Service Client will call the /static_map service in order to get the map data, and will print the dimensions and resolution of the map.</p><p><img data-src="/assets/images/ROS/Nav/17.png" alt="" data-proofer-ignore></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">#! /usr/bin/python2
</span>
<span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">nav_msgs.srv</span> <span class="kn">import</span> <span class="n">GetMap</span><span class="p">,</span> <span class="n">GetMapRequest</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">'call_map'</span><span class="p">)</span>
<span class="n">rospy</span><span class="p">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/static_map'</span><span class="p">)</span>

<span class="n">map_data</span> <span class="o">=</span> <span class="n">GetMapRequest</span><span class="p">()</span>

<span class="n">srv</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/static_map'</span><span class="p">,</span><span class="n">GetMap</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">srv</span><span class="p">(</span><span class="n">map_data</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nb">map</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">resolution</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nb">map</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">width</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nb">map</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">height</span><span class="p">)</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">spin</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="/assets/images/ROS/Nav/18.png" alt="" data-proofer-ignore></p><h3 id="124-creating-a-slam-launch-file"><span class="mr-2">1.2.4 Creating a SLAM launch file</span><a href="#124-creating-a-slam-launch-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Till now we have used a previously created gmapping node to obtain a map of the environment. We shall now see how to create our own launch file. The main task to create this launch file is to correctly set the parameters for the turtlebot3_slam_gmapping node. This node is highly configurable and has lots of parameters that can be changed in order to improve the mapping performance. These parameters are read from the ROS Parameter Server, which can be set either in the launch file itself or in a separate YAML file.</p><p><img data-src="/assets/images/ROS/Nav/19.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/20.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/21.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/ROS/Nav/22.png" alt="" data-proofer-ignore></p><h4 id="parameters"><span class="mr-2">Parameters</span><a href="#parameters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>You can refer to http://wiki.ros.org/gmapping for the list of various parameters available for the gmapping package.</p><h2 id="13-localization"><span class="mr-2">1.3 Localization</span><a href="#13-localization" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In the previous section, we have seen how to obtain a map of the given environment using the robot’s sensor data. When the robot uses this map to navigate, it is necessary for it to know its position withing the map, and its orientation as well. Determining the location and pose of a robot by using its sensor readings is known as Localization.</p><h3 id="131-monte-carlo-localization"><span class="mr-2">1.3.1 Monte Carlo Localization</span><a href="#131-monte-carlo-localization" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Monte Carlo Localization (MCL) or particle filter localization is an algorithm used by robots to localize themselves in an environment. As the robot navigates the environment, the algorithm generates random guesses (called particles) about the next possible position of the robot. As the robot gathers more sensor data, the algo discards particles that don’t match with the readings and generates more particles closer to the probable sensor readings. So the more the robot moves, the more data we get from the sensors and the more precise is the localization.</p><blockquote><p>Read more</p><p><a href="https://en.wikipedia.org/wiki/Monte_Carlo_localization">https://en.wikipedia.org/wiki/Monte_Carlo_localization</a></p><p>https://in.mathworks.com/help/nav/ug/monte-carlo-localization-algorithm.html</p></blockquote><h3 id="132-amcl-package"><span class="mr-2">1.3.2 amcl package</span><a href="#132-amcl-package" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The AMCL (Adaptive Monte Carlo Localization) package provides the <strong>amcl</strong> node which uses the MCL algorithm to track the localization of the robot in 2D space. The node subscribes to the laser data and transformations of the robot, and publishes the estimated position of the robot in the map. On startup, the amcl node initializes its particle filter according to the parameters provided.</p><ol><li><p>Launch gazebo - <code class="language-plaintext highlighter-rouge">roslaunch turtlebot3_gazebo turtlebot3_house.launch</code></p><li><p>We have previously saved the map of the gazebo-house environment in <code class="language-plaintext highlighter-rouge">catkin_ws/src</code>. In order to use a previously existing amcl node with turtlebot3 on our map, we need to copy the saved map into the directory in which the amcl node is located.</p><p><img data-src="/assets/images/ROS/Nav/23.png" alt="" data-proofer-ignore></p><li><p>Open the relevant launch file using the command <code class="language-plaintext highlighter-rouge">code ~/catkin_ws/src/turtlebot3/turtlebot3_navigation/launch/turtlebot3_navigation.launch</code> and change the map name in line 4 from <code class="language-plaintext highlighter-rouge">map.yaml</code> to <code class="language-plaintext highlighter-rouge">my_map.yaml</code>.</p><p><img data-src="/assets/images/ROS/Nav/24.png" alt="" data-proofer-ignore></p><li><p>Save the launch file, do <code class="language-plaintext highlighter-rouge">catkin_make</code> and source your workspace.</p><li><p>Now to launch the amcl node with gazebo running, use the command <code class="language-plaintext highlighter-rouge">roslaunch turtlebot3_navigation turtlebot3_navigation.launch</code></p></ol><p><img data-src="/assets/images/Nav/25.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/26.png" alt="" data-proofer-ignore></p><h4 id="rviz-1"><span class="mr-2">Rviz:</span><a href="#rviz-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>On entering the above commands, you will see something like this.</p><p><img data-src="/assets/images/Nav/27.png" alt="" data-proofer-ignore></p><p>For now, you can remove a few of the displays and keep only the ones shown in the image below.</p><p><img data-src="/assets/images/Nav/28.png" alt="" data-proofer-ignore></p><p>In order to visualize localization, we use the PoseArray display. Using the 2D Pose Estimate Tool, set an approximate initial position and orientation for the robot on Rviz (need not be accurate).</p><p>On moving your robot around using your keyboard, you will notice that the particle cloud shrinks in size due to the scan data allowing amcl to refine its estimate of the robot’s pose.</p><p><img data-src="/assets/images/Nav/29.png" alt="" data-proofer-ignore></p><h4 id="topics"><span class="mr-2">Topics:</span><a href="#topics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>The initial pose set up using the 2D Pose Estimate tool on Rviz is published into the <strong>/initialpose</strong> topic.<li>The amcl node read data published into the <strong>/scan</strong> topic (laser readings), <strong>/map</strong> topic and <strong>/tf</strong> topic, and published the estimate pose of the robot into the <strong>/amcl_pose</strong> and <strong>/particlecloud</strong> topics.</ul><p><img data-src="/assets/images/Nav/30.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/31.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/32.png" alt="" data-proofer-ignore></p><h3 id="133-services"><span class="mr-2">1.3.3 Services</span><a href="#133-services" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <strong>amcl</strong> node provides the following services:</p><ul><li><strong>/global_localization (std_srvs/Empty)</strong>: amcl node provides this service wherein all particles are dispersed randomly throughout the free space in the map.<li><strong>/static_map (nav_msgs/GetMap)</strong>: when called, this service is used to retreive map info for localization</ul><p><img data-src="/assets/images/Nav/33.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/34.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/35.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/36.png" alt="" data-proofer-ignore></p><p>When you call the /global_localization service, you see something like this on Rviz. Syntax: <code class="language-plaintext highlighter-rouge">rosservice call /global_localization "{}"</code></p><p><img data-src="/assets/images/Nav/37.png" alt="" data-proofer-ignore></p><h4 id="creating-a-service-server"><span class="mr-2">Creating a Service Server</span><a href="#creating-a-service-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Code for a service server that returns the position and orientation of the robot at the moment when the service is called.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="c1">#! /usr/bin/python2
</span>
<span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">geometry_msgs.msg</span> <span class="kn">import</span> <span class="n">PoseWithCovarianceStamped</span>
<span class="kn">from</span> <span class="nn">std_srvs.srv</span> <span class="kn">import</span> <span class="n">Empty</span><span class="p">,</span> <span class="n">EmptyResponse</span>

<span class="n">bot_pose</span> <span class="o">=</span> <span class="n">PoseWithCovarianceStamped</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">serv_func</span><span class="p">(</span><span class="n">req</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Pose:"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">bot_pose</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">EmptyResponse</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">sub_func</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">bot_pose</span>
    <span class="n">bot_pose</span> <span class="o">=</span> <span class="n">msg</span><span class="p">.</span><span class="n">pose</span><span class="p">.</span><span class="n">pose</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">'service_server'</span><span class="p">)</span>

<span class="n">srv</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Service</span><span class="p">(</span><span class="s">'my_pose_service'</span><span class="p">,</span><span class="n">Empty</span><span class="p">,</span><span class="n">serv_func</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">'/amcl_pose'</span><span class="p">,</span><span class="n">PoseWithCovarianceStamped</span><span class="p">,</span><span class="n">sub_func</span><span class="p">)</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">spin</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="/assets/images/Nav/38.png" alt="" data-proofer-ignore></p><h4 id="creating-a-service-client-1"><span class="mr-2">Creating a Service Client</span><a href="#creating-a-service-client-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Code for a service client which performs a call to the <strong>/global_localization</strong> service in order to disperse the particles.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">#! /usr/bin/python2
</span>
<span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">std_srvs.srv</span> <span class="kn">import</span> <span class="n">Empty</span><span class="p">,</span> <span class="n">EmptyRequest</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">'client_global_localization'</span><span class="p">)</span>
<span class="n">rospy</span><span class="p">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'global_localization'</span><span class="p">)</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">EmptyRequest</span><span class="p">()</span>

<span class="n">srv</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'global_localization'</span><span class="p">,</span><span class="n">Empty</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">srv</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">spin</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="/assets/images/Nav/39.png" alt="" data-proofer-ignore></p><h3 id="134-creating-a-launch-file"><span class="mr-2">1.3.4 Creating a launch file</span><a href="#134-creating-a-launch-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Till now we have used a previously created amcl node (slightly modified) to obtain a map of the environment. We shall now see how to create our own launch file. As mentioned before, the main task to create a launch file is to correctly set the parameters for the amcl node.</p><p><img data-src="/assets/images/Nav/40.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/41.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/42.png" alt="" data-proofer-ignore></p><p>The basic structure of the launch files will be the same as shown above. All you have to do is change the parameters to obtain different outputs.</p><h4 id="parameters-1"><span class="mr-2">Parameters</span><a href="#parameters-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>You can refer to http://wiki.ros.org/amcl for the list of various parameters available for the amcl package.</p><h2 id="14-path-planning"><span class="mr-2">1.4 Path Planning</span><a href="#14-path-planning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="141-move_base-package"><span class="mr-2">1.4.1 move_base package</span><a href="#141-move_base-package" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <strong>move_base</strong> package provides the <strong>move_base</strong> node, which is one of the most important elements of the ROS Navigation Stack that links all processes that take place in the navigation process. The main function of the <strong>move_base</strong> node is to move the robot from the current position to the target position. It is an implementation of a <em>Simple Action server</em>.</p><ol><li><p>Launch gazebo - <code class="language-plaintext highlighter-rouge">roslaunch turtlebot3_gazebo turtlebot3_house.launch</code></p><li><p>We now need to make a few small changes to a previously existing launch file. To do so, first go to the ROS directory <code class="language-plaintext highlighter-rouge">turtlebot3_navigation</code>, and open the launch file <code class="language-plaintext highlighter-rouge">turtlebot3_navigation.launch</code> present under the <code class="language-plaintext highlighter-rouge">launch</code> folder.</p><p><img data-src="/assets/images/Nav/43.png" alt="" data-proofer-ignore></p><li><p>After that, uncomment the following lines in the code</p><p><img data-src="/assets/images/Nav/44.png" alt="" data-proofer-ignore></p><li><p>Save the file, go back to your ROS Workspace, do a <code class="language-plaintext highlighter-rouge">catkin_make</code> and source your workspace.</p><li><p>Now with gazebo running, launch the file containing the required move_base node using the command <code class="language-plaintext highlighter-rouge">roslaunch turtlebot3_navigation turtlebot3_navigation.launch</code>.</p></ol><h4 id="rviz-2"><span class="mr-2">Rviz:</span><a href="#rviz-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img data-src="/assets/images/Nav/45.png" alt="" data-proofer-ignore></p><p>Using the <strong>2D Nav Goal</strong> tool you can goals to your robot, instructing it to move to a particular location in the map.</p><p><img data-src="/assets/images/Nav/46.png" alt="" data-proofer-ignore></p><h4 id="topics-1"><span class="mr-2">Topics:</span><a href="#topics-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The goals are sent to the robot using the <strong>2D Nav Tool</strong> on Rviz through the <strong>/move_base/goal</strong> topic.</p><p><img data-src="/assets/images/Nav/47.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/48.png" alt="" data-proofer-ignore></p><p>On doing a <strong>rostopic echo</strong> on the above mentioned topic, we can listen to the messages being published through it. Initially, when no messages are being published, we do not see anything. But if we send a target location to the robot using the <strong>2D Nav Tool</strong> on Rviz, we get a message of the following type</p><p><img data-src="/assets/images/Nav/49.png" alt="" data-proofer-ignore></p><p>We can now send goals to the robot directly, without using Rviz, using the command <code class="language-plaintext highlighter-rouge">rostopic pub /move_base/goal move_base_msgs/MoveBaseActionGoal &lt;parameters&gt;</code>.</p><p>Other relevant topics:</p><p><img data-src="/assets/images/Nav/50.png" alt="" data-proofer-ignore></p><p>When the <strong>move_base</strong> node receives a goal pose, it links other components such as the global planner, local planner, recovery behaviours, and costmaps, and generates an output which is a velocity command with the message type <strong>geometry_msgs/Twist</strong>, and sends it to the <strong>/cmd_vel</strong> topic in order to move the robot.</p><h3 id="142-actions"><span class="mr-2">1.4.2 Actions</span><a href="#142-actions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>As mentioned before, the move_base node is an implementation of an Action Server. This makes it possible for us to send goals, receive feedback and results, and even cancel a goal if necessary. The action server takes a goal pose with the message type <strong><em>geometry_msgs/PoseStamped</em></strong>. This allows us to send goals to the server using a simple Action Client.</p><p>The Action server provides the topic <strong>move_base/goal</strong>, which is the input of the navigation stack, and uses this topic to provide the goal pose.</p><h4 id="action-client"><span class="mr-2">Action Client</span><a href="#action-client" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Ex 4.4</p><h3 id="143-creating-a-launch-file"><span class="mr-2">1.4.3 Creating a launch file</span><a href="#143-creating-a-launch-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We shall now see how to create our own move_base launch file. This node also has a lot of parameters associated with it that can be configured.</p><p><img data-src="/assets/images/Nav/51.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/52.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/Nav/53.png" alt="" data-proofer-ignore></p><h4 id="parameters-2"><span class="mr-2">Parameters</span><a href="#parameters-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>You can refer to http://wiki.ros.org/move_base for the list of various parameters available for the move_base package.</p><h3 id="144-the-global-planner"><span class="mr-2">1.4.4 The Global Planner</span><a href="#144-the-global-planner" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Whenever a new goal is received by the move_base node, the goal messages are also sent to the global planner. The lobal planner is responsible for calculating a safe path in order to arrive at the goal pose. This path is calculated before the robot starts moving, so it will not take into account the sensor data of the robot while moving.</p><p>There are different types of global planners that different robots use to navigate an environment. Some of the important global planners are:</p><h4 id="navfn"><span class="mr-2">Navfn</span><a href="#navfn" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The Navfn planner is one of the most commonly used global planners in the ROS Navigation Stack. It uses the <strong>Djikstra’s algorithm</strong> to calculate the shortest path between the initial and target pose of the robot.</p><p>Reference: https://github.com/ros-planning/navigation/tree/melodic-devel/navfn</p><h4 id="global-planner"><span class="mr-2">Global Planner</span><a href="#global-planner" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The global planner is a more flexible replacement to the Navfn planner. It allows you to change the algorithm used for path planning (Djikstra’s in case of Navfn). These options include support for A*, toggling quadratic approximation, and toggling grid path.</p><p>Reference: https://github.com/ros-planning/navigation/tree/melodic-devel/global_planner</p><h4 id="carrot-planner"><span class="mr-2">Carrot Planner</span><a href="#carrot-planner" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The Carrot planner takes the goal pose and checks if this goal is an obstacle. If it is an obstacle, it walks back along the vector between the goal and the robot until a goal point where the obstacle is not found. This planner is useful if you require your robot to move close to the given goal, even if the goal is unreachable.</p><p>Reference: https://github.com/ros-planning/navigation/tree/melodic-devel/carrot_planner</p><h3 id="145-the-local-planner"><span class="mr-2">1.4.5 The Local Planner</span><a href="#145-the-local-planner" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Once the global planner has calculated the path to follow, this path is sent to the local planner. The local planner will then execute each segment of the global plan. With the help of the plan provided by the global planner and a map, the local planner will send velocity commands in order to move the robot.</p><p>The local planner monitors the odometry and laser data from the robot and chooses a collision-free local plan. It can recompute the robot’s path while it is moving in order to keep the robot from colliding with obstacles.</p><h4 id="base_local_planner"><span class="mr-2">base_local_planner</span><a href="#base_local_planner" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The base_local_planner provides an implementation of the Trajectory Rollout and Dynamic Window Approach (DWA). The basic idea of how the algorithm works is as follows:</p><ul><li>Samples the robot space.<li>For each sampled velocity, it performs simulations to predict the outcomes when the sampled velocity is applied.<li>It evaluates the trajectory resulting from the simulation and discards the unwanted trajectories.<li>It picks the best trajectory and sends the associated velocity commands for the robot to move</ul><p>Trajectory Rollout samples are from a set of achievable velocities ove the entire simulation, while DWA samples are from the set of achievable velocities for just one simulation step.</p><h4 id="dwa_local_planner"><span class="mr-2">dwa_local_planner</span><a href="#dwa_local_planner" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The dwa_local_planner provides an implementation of the Dynamic Window Approach (DWA) algorithm. It is basically a cleaner version of the base local planner’s DWA option.</p><p>You can find the list of parameters associated with the DWA planner <a href="http://wiki.ros.org/dwa_local_planner">here</a>.</p><h3 id="146-costmaps"><span class="mr-2">1.4.6 Costmaps</span><a href="#146-costmaps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>A costmap is a map that represents place that are safe for the robot to be in a grid of cells. Unusally the values in the costmap are binary, representing either free space orplaces where the robot would be in collision. Each cell in a costmap has an integer value in the range {0,255}.</p><ul><li>255 (NO_INFORMATION): Cells that do not contain enough information<li>254 (LETHAL_OBSTACLE): Indicates presence of obstacle in a cell<li>253 (INSCRIBED_INFLATED_OBSTACLE): Indicates no obstacle but moving the robot to this location will result in a collision<li>0 (FREE_SPACE): No obstacle in the cell</ul><p>There are 2 types of costmaps:</p><ol><li>Global Costmap - created from static map<li>Local Costmap - created from sensor readings</ol><p>Costmap parameters are defined in 3 different files:</p><ol><li>A YAML file that sets the parameters for the global costmap - <em>global_costmap_params.yaml</em><li>A YAML file that sets the parameters for the local costmap - <em>local_costmap_params.yaml</em><li>A YAML file that sets the parameters for both the global and local costmaps - <em>costmap_common_params.yaml</em></ol><h4 id="global-costmap"><span class="mr-2">Global Costmap</span><a href="#global-costmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The global costmap is created from a user-generated static map and is used by the global planner. It is initialized to match the width, height, and obstacle information provided by the static map.</p><p>The global costmap has its own set of parameters defined in a YAML file.</p><p><img data-src="/assets/images/Nav/54.png" alt="" data-proofer-ignore></p><p>See Parameters section of http://wiki.ros.org/costmap_2d</p><h4 id="local-costmap"><span class="mr-2">Local Costmap</span><a href="#local-costmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The local costmap is created from the sensor readings taken from the robot and is used by the local planner.</p><p>The local costmap too has its own set of parameters defined in a YAML file.</p><p><img data-src="/assets/images/Nav/55.png" alt="" data-proofer-ignore></p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blog/'>Blog</a>, <a href='/categories/robotics/'>Robotics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ros/" class="post-tag no-text-decoration" >ros</a> <a href="/tags/navigation/" class="post-tag no-text-decoration" >navigation</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.facebook.com/sharer/sharer.php?title=ROS+Navigation+-+Bhaswanth+Ayapilla&u=https%3A%2F%2Fbhaswanth-a.github.io%2F%2Fposts%2Fros-nav%2F" data-toggle="tooltip" data-placement="top" title="Instagram" target="_blank" rel="noopener" aria-label="Instagram"> <i class="fa-fw fab fa-instagram"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ROS+Navigation+-+Bhaswanth+Ayapilla&u=https%3A%2F%2Fbhaswanth-a.github.io%2F%2Fposts%2Fros-nav%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fbhaswanth-a.github.io%2F%2Fposts%2Fros-nav%2F&text=ROS+Navigation+-+Bhaswanth+Ayapilla" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fbhaswanth-a.github.io%2F%2Fposts%2Fros-nav%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/intro-to-rl/">Introduction to Reinforcement Learning</a><li><a href="/posts/reinforcement-learning/">Reinforcement Learning</a><li><a href="/posts/deep-rl/">Deep Reinforcement Learning</a><li><a href="/posts/lunar-roadster-cmu/">Lunar ROADSTER</a><li><a href="/posts/cmu-blog/">Coursework at CMU</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/learning/">learning</a> <a class="post-tag" href="/tags/nnets/">nnets</a> <a class="post-tag" href="/tags/rl/">rl</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/arduino/">arduino</a> <a class="post-tag" href="/tags/computer-vision/">computer vision</a> <a class="post-tag" href="/tags/control/">control</a> <a class="post-tag" href="/tags/electronics/">electronics</a> <a class="post-tag" href="/tags/manipulators/">manipulators</a> <a class="post-tag" href="/tags/ml/">ml</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ros-theory/"><div class="card-body"> <em class="small" data-ts="1659024000" data-df="ll" > Jul 28, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ROS Theory</h3><div class="text-muted small"><p> Synopsis ROS is an open-source project that provides a framework to your robot. It has become an integral part of robots today, and has massively impacted the Robotics Arena. ROS is extremely fasc...</p></div></div></a></div><div class="card"> <a href="/posts/ros-manipulator/"><div class="card-body"> <em class="small" data-ts="1659024000" data-df="ll" > Jul 28, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Robotic Arm on ROS</h3><div class="text-muted small"><p> Introduction The aim of this project is to build a robot manipulator on ROS (Robot Operating System). A robot manipulator is a basically a set of links and joints that together forms an arm. By ...</p></div></div></a></div><div class="card"> <a href="/posts/sauvc-sim/"><div class="card-body"> <em class="small" data-ts="1661961600" data-df="ll" > Aug 31, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AUV Simulation</h3><div class="text-muted small"><p> Simulation is an important aspect of building an Autonomous Underwater Vehicle (AUV). It allows the team to test and validate the robot’s design and performance in a controlled environment before d...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ros-manipulator/" class="btn btn-outline-primary" prompt="Older"><p>Robotic Arm on ROS</p></a> <a href="/posts/ros-theory/" class="btn btn-outline-primary" prompt="Newer"><p>ROS Theory</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "Bhaswanth-A/bhaswanth-a.github.io", "data-repo-id": "R_kgDOHu5z_w", "data-category": "General", "data-category-id": "DIC_kwDOHu5z_84C0yVx", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/Bhaswanth-A">Bhaswanth Ayapilla</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/learning/">learning</a> <a class="post-tag" href="/tags/nnets/">nnets</a> <a class="post-tag" href="/tags/rl/">rl</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/arduino/">arduino</a> <a class="post-tag" href="/tags/computer-vision/">computer vision</a> <a class="post-tag" href="/tags/control/">control</a> <a class="post-tag" href="/tags/electronics/">electronics</a> <a class="post-tag" href="/tags/manipulators/">manipulators</a> <a class="post-tag" href="/tags/ml/">ml</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-CJ97GH1VYR"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-CJ97GH1VYR'); }); </script>
